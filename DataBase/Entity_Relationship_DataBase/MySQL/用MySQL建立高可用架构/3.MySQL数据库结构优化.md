#MySQL数据库结构优化

在设计数据库的时候不仅要考虑业务需要，也要考虑将来编写什么样的查询语句才可以得到这样的效果。良好的数据库逻辑设计和物理设计是数据库获得高性能的基础。

1.数据库结构优化介绍

数据库结构优化的目的

>1.减少数据冗余（而不是完全消除冗余）

>2.尽量避免数据维护中出现的更新、插入和删除异常（表中的某个实体依靠另外一个实体而存在的情况）

>3.节约数据库的存储空间

>4.提高查询效率

2.数据库结构设计

数据库设计步骤

>1.需求分析：了解产品设计的存储需求、数据处理需求、数据的生命周期和数据的安全和完整性需求

>2.逻辑设计：不关心数据库的选择或者存储引擎的选择，只设计数据的逻辑存储结构、数据实体之间的逻辑关系，解决数据冗余和数据维护异常（数据库范式）

>3.物理设计：根据所使用的数据库特点进行表结构设计（关系型数据库或者非关系型数据库、不同的存储引擎）

>4.维护优化：根据实际情况对索引、存储结构进行优化，数据字典的维护

数据库设计范式

不一定完全按照范式来设计数据库，有时为了提高某些数据的查询效率，可以做出适当的反范式设计

>1.第一范式：数据库表中的所有字段都只有单一属性，而且单一属性的列是由基本的数据类型所构成的，设计出来的表都是简单的二位表

>2.第二范式：表中有且只有一个主键

>3.第三范式：每个非主属性既不部分依赖于也不传递依赖与业务主键。

3.需求分析及逻辑设计

举例：设计一个电子商务网站的数据库结构

>1.本网站只销售图书类的商品

>2.需要具有以下功能：用户登录，用户管理，商品展示，商品管理，供应商管理，在线销售

用户登录及用户管理功能--

用户必须注册并登录系统才能进行网上交易，用户必须有一个唯一的标识码来区别（可以使用id作为用户信息的业务主键）

保障安全性，同一时间一个用户只能在一个地方登录，系统必须记录用户的登录状态

用户在登录时必须提供一些用户信息：用户名、密码、手机号、姓名、出生日期、注册日期（系统维护）、在线状态（系统维护）、、、

商品展示及商品管理功能

商品信息：商品名称，出版社名称（可能一本书有多个出版社联合出版），图书价格，图书描述，作者（可能一本书有多个作者）

分类信息：分类名称、分类描述

商品分类（对应关系表）：商品名称、分类名称

供应商管理功能

供应商信息：出版社名称、地址、电话、联系人、银行帐号

在线销售模块（核心）

在线销售：订单编号，下单用户名，下单日期，订单金额，订单商品分类，订单商品名，订单商品单价，订单商品数量，支付金额，物流单号

改良：

订单表：订单编号，下单用户名，下单日期，支付金额，物流单号（订单的价格可以通过计算得出）

订单商品的关联表：订单编号，订单商品分类，订单商品名，商品数量

（以上设计虽然符合范式，但是在查询时关联的表过多，造成查询效率低下；此外在商品表中记录商品价格，导致商品的单价无法变化，查询历史订单的时候用户希望看到当时购买的价格而不是现在的售价）

4.需求分析及逻辑设计--反范式化设计

5.范式化设计和反范式化设计的优缺点

6.物理设计介绍

7.物理设计-数据类型的选择

8.物理设计-如何存储日期类型
